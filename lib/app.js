(()=>{"use strict";var e={601:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default={ROOT:"",CURR_DIR:"",BASE_PATHS:{},CONFIG:{"slug-type":":*slug*","copy-to-current-directory":!1,"include-path-name":!1,"include-base-paths":!0,"path-type":"string","const-name":"ENDPOINTS",endpoints:{}}}},16:function(e,t,n){var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=u(n(601)),a=u(n(147)),o=u(n(17)),s=u(n(473)),f=u(n(172));t.default=()=>{const e=l.default.CURR_DIR,t=o.default.resolve(__dirname,"..","dist");a.default.existsSync(t)||s.default.fatal("Could not find the dist folder.");const n=a.default.readdirSync(t);n&&0!==n.length||s.default.fatal("Could not find any files to copy."),n.forEach((n=>{const u=a.default.readFileSync(t+"/"+n,"utf-8");(0,f.default)(e,n,u)})),s.default.success(`Added files to ${e}`)}},497:function(e,t,n){var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=u(n(172)),a=u(n(257)),o=u(n(170)),s=u(n(473)),f=u(n(601));t.default=async()=>{const e=await(0,a.default)();if(!e)return s.default.fatal("Could not find root dir! Please create endpoint.config.json manually. \n You can find the config schema here: node_modules/endpoint-builder/endpoint.schema.json"),!1;const t=Object.assign(Object.assign({$schema:"node_modules/endpoint-builder/endpoint.schema.json"},f.default.CONFIG),{"file-prefixes":['type Example = "an example of prefixing the file with additional types" | string'],endpoints:{GET:{suffix:["id:number","type:Example"]},GET_ALL:{}},folders:{SRC:{path:"src/.."}},parents:{BACKEND:{"path-type":"string","include-path-name":!1},FRONTEND:{"path-type":"function","include-path-name":!0}},paths:["user","post"]});return(0,l.default)(e,"endpoint.config.json",JSON.stringify(t,null,2)),await(0,o.default)()}},257:function(e,t,n){var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=u(n(345));t.default=async()=>{const e=await(0,l.default)(process.cwd(),"node_modules");return!!e&&!!e.includes("node_modules")&&e.replace("node_modules","")}},345:function(e,t,n){var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=u(n(147)),a=u(n(17)),o=async(e=__dirname,t)=>(await l.default.promises.readdir(e)).includes(t)?a.default.join(e,t):"/"!==e&&o(a.default.resolve(e,".."),t);t.default=o},170:function(e,t,n){var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=u(n(601)),a=u(n(345)),o=u(n(736));t.default=async(e="endpoint.config.json")=>{const t=await(0,a.default)(__dirname,e);if(!t)return!1;const n=(0,o.default)(t);return!!n&&(l.default.ROOT=t.replace(e,""),JSON.parse(n))}},736:function(e,t,n){var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=u(n(147));t.default=e=>!!l.default.existsSync(e)&&l.default.readFileSync(e,{encoding:"utf-8"})},172:function(e,t,n){var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=u(n(147)),a=u(n(473));t.default=function(e,t,n){try{return l.default.writeFileSync(e+"/"+t,n),!0}catch(n){a.default.fatal(`Could not write ${t} to ${e}!`)}}},581:function(e,t,n){var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=u(n(601));t.default=()=>{let e="BASE: {";for(const[t,n]of Object.entries(l.default.BASE_PATHS))e+=`\n\t${t}: "${n}",`;return e+="\n},",e}},907:function(e,t,n){var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=u(n(601)),a=u(n(581)),o=u(n(644)),s=u(n(712)),f=u(n(318));t.default=()=>{let e=`const ${l.default.CONFIG["const-name"]} = {\n`;return l.default.CONFIG.parents?e+=(0,s.default)((0,f.default)(l.default.CONFIG.parents)):e+=(0,s.default)((0,o.default)(l.default.CONFIG["path-type"],l.default.CONFIG["include-base-paths"])),e+="\r",l.default.CONFIG["include-base-paths"]&&(e+=(0,s.default)((0,a.default)())),e+="\n};\n",e+=`export default ${l.default.CONFIG["const-name"]}`,e}},133:function(e,t,n){var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=u(n(601));t.default=()=>{if(!l.default.CONFIG["file-prefixes"]||0===l.default.CONFIG["file-prefixes"].length)return"";let e="";return l.default.CONFIG["file-prefixes"].forEach((t=>{e+=`${t}\n`})),e}},318:function(e,t,n){var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=u(n(712)),a=u(n(644));t.default=e=>{let t="";for(const[n,u]of Object.entries(e)){t+=`${n}: {\n`;const e=(0,a.default)(u["path-type"],u["include-path-name"]);t+=(0,l.default)(e),t+="\r",t+="},\n"}return t}},644:function(e,t,n){var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=u(n(601)),a=u(n(800)),o=u(n(149)),s=u(n(777)),f=u(n(473));t.default=function(e="string",t=!1){const n=l.default.CONFIG.endpoints;n&&0!==Object.keys(n).length||f.default.fatal("No endpoints found!");let u="";for(const[f,r]of Object.entries(n)){const n=!!r.exclude&&r.exclude.map((e=>(0,a.default)(e).key)),d=!!r.include&&r.include,i=!!r.excludeAll&&r.excludeAll,c=r.suffix?r.suffix:"",p=!!r.custom&&r.custom;u+=`${f}: {`;let _=0;for(const[a,f]of Object.entries(l.default.BASE_PATHS)){const l=t?f:"",r=Array.isArray(c)?`${a}: "${""!==l?l+"/":""}${(0,s.default)(c).toString}",`:`${a}: "${l}",`,p=Array.isArray(c)?(0,s.default)(c):void 0;let h="function"===e?`${a}: ${(0,o.default)(t?f:"",p)},`:r;i||(d?d.includes(a)&&(u+="\n\t"+h):n&&n.includes(a)||(u+="\n\t"+h)),_++}if(p)for(const[n,l]of Object.entries(p)){const a=n.toLocaleLowerCase().replace("_","-");u+="\n\t"+("function"===e?`${n}: ${(0,o.default)(t?a:"",(0,s.default)(l))},`:`${n}: "${t?a+"/":""}${(0,s.default)(l).toString}",`)}u+="\n},\n"}return u}},758:function(e,t,n){var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=u(n(601)),a=u(n(497)),o=u(n(170)),s=u(n(473)),f=u(n(51)),r=u(n(137));t.default=async()=>{s.default.message("Looking for endpoint.config.json");let e=await(0,o.default)();e||(s.default.warning("Attempting to create config..."),e=await(0,a.default)(),e?(s.default.success(`Created a config file at ${l.default.ROOT}`),s.default.message("Added example data to the config file, please fit it to your needs"),process.exit()):s.default.fatal("Could not create endpoint.config.json. Please add it manually.")),l.default.CONFIG=Object.assign(Object.assign({},l.default.CONFIG),e),(0,f.default)(),(0,r.default)(),0===Object.keys(l.default.BASE_PATHS).length&&s.default.fatal("Error. No paths were added! Check your config settings.")}},51:function(e,t,n){var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=u(n(147)),a=u(n(601)),o=u(n(800)),s=u(n(150)),f=u(n(473));t.default=function(){const e=a.default.CONFIG.folders;if(!e)return;const t={};f.default.message("Checking folders...");let n=0;for(const[u,{path:r,exclude:d,include:i}]of Object.entries(e)){const e=d||[],c=i||[];l.default.existsSync(a.default.ROOT+"/"+r)||f.default.fatal(`Could not find folders ${u} path: '${r}'. Please check your endpoint.config.json and make sure the path is relative to where the config file is and does not start with a /`);const p=l.default.readdirSync(a.default.ROOT+r);n+=p.length,f.default.message(`Found ${p.length} files in '${u}'`),p.forEach((u=>{if(0!==u.indexOf("."))if(c.length>0){u=(0,s.default)(u);const{key:e,value:n}=(0,o.default)(u);t[e]=n}else{if(e.includes(u))return;u=(0,s.default)(u);const{key:n,value:l}=(0,o.default)(u);t[n]=l}else n-=1}))}0===Object.keys(t).length&&f.default.warning("No paths were generated from the folders options. Make sure the folders aren't empty or that the path is correct."),Object.keys(t).length!==n&&f.default.warning("Found more files then were created for the final endpoint. Filenames must be unique or they will be overwritten"),a.default.BASE_PATHS=Object.assign(Object.assign({},a.default.BASE_PATHS),t)}},137:function(e,t,n){var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=u(n(601)),a=u(n(800));t.default=()=>{const e=l.default.CONFIG.paths;if(!e)return;const t={};e.forEach((e=>{const{key:n,value:u}=(0,a.default)(e);t[n]=u})),l.default.BASE_PATHS=Object.assign(Object.assign({},l.default.BASE_PATHS),t)}},800:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>({key:e.toUpperCase().replace(/_/g,"-"),value:e.toLowerCase()})},149:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=(e,t)=>{let n="(",u=`=> ("${e}"`;if(""===e&&(u="=> ("),!t)return n+=")",u+=")",n+" "+u;for(let l=0;l<t.types.length;l++){const a=t.types[l],o=t.suffixes[l];(0!==l&&""===e||""!==e)&&(u+=" + "),null!==a?(n+=`${o}: ${a}, `,u+=`"/" + ${o}`):u+=`"/${o}"`}return","===n[n.length-2]&&(n=n.slice(0,n.length-2)),n+=")",u+=")",n+" "+u}},150:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>e.includes(".")?e.slice(0,e.lastIndexOf(".")).replace(/./g,"-"):e},777:function(e,t,n){var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=u(n(601)),a=e=>{let t="",n="",u="",a=!0,o=!1;for(let l=0;l<e.length;l++){const s=e[l];o&&(u+=s),":"===s&&(a=!1,o=!0),a&&(n+=s,t+=s)}return""===u&&(u=null),{suffix:n,type:u,slug:e.includes(":")?l.default.CONFIG["slug-type"].replace("*slug*",t):null}};t.default=e=>{const t=[],n=[],u=[];for(let l=0;l<e.length;l++){const{suffix:o,type:s,slug:f}=a(e[l]);n.push(o),u.push(s),t.push(f)}if(n.length!==u.length)throw new Error("Could not read suffixes");const l=t.map(((e,t)=>e||n[t])).join("/");return{suffixes:n,types:u,slugs:t,toString:l}}},712:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>e.replace(/^/gm,"\t")},607:function(e,t,n){var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=u(n(172)),a=u(n(16)),o=u(n(907)),s=u(n(758)),f=u(n(473)),r=u(n(17)),d=u(n(133)),i=u(n(601));t.default=async()=>{try{i.default.CURR_DIR=process.cwd(),await(0,s.default)();const e=(0,o.default)(),t=(0,d.default)();return(0,l.default)(r.default.resolve(__dirname,".."),"index.ts",t+"\n"+e),{CONSTANTS:i.default,logger:f.default,copyToCurrDir:a.default}}catch(e){e instanceof Error&&f.default.fatal("An unknown error occurred: "+e.message)}}},473:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=["[2m","🚀 Endpoint builder:"],u={message:e=>{console.log(n[0],n[1],"[0m","[37m",e,"[0m")},success:e=>{console.log(n[0],n[1],"[0m","[32m","Success:","[32m",e,"[0m")},error:e=>{console.log(n[0],n[1],"[0m","[31m","ERROR:","[31m",e,"[0m")},warning:e=>{console.log(n[0],n[1],"[0m","[33m","Warning:","[33m",e,"[0m")},fatal:e=>{console.log(n[0],n[1],"[0m","[31m","FATAL ERROR:","[31m",e,"[0m"),console.log(n[0],n[1],"[0m","[31m","FATAL ERROR:","[31m","ABORTING","[0m"),process.exit()}};t.default=u},147:e=>{e.exports=require("fs")},17:e=>{e.exports=require("path")}},t={},n=function n(u){var l=t[u];if(void 0!==l)return l.exports;var a=t[u]={exports:{}};return e[u].call(a.exports,a,a.exports,n),a.exports}(607);exports.endpointBuilder=n})();